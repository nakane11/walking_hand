(require "package://kxreus/euslisp/kxr-interface.l")

(kxr-init :create-viewer nil)

(setq walk-angle
      (list #f(20.2163 29.0588 36.2475 13.23 11.5425 73.6425 138.004 2.09251 28.755 7.83001 27.6413 1.24876 -7 94.474 81.8825 1.62001 9.24751 25.1438 45.765)
            #f(18.5963 28.7213 36.2475 13.905 0 74.655 141.514 1.14751 27.7763 7.52626 27.0 0.60751 -15 93.7988 81.0438 0.97876 1.99126 25.785 45.1238)
            #f(18.5963 28.7213 36.2475 13.905 0.0 60.0 141.514 1.14751 27.7763 7.52626 27.0 0.60751 -15 60.0 71.0438 0.97876 1.99126 25.785 45.1238)
            #f(18.5963 28.7213 36.2475 13.905 0.0 30.0 141.514 1.14751 27.7763 7.52626 27.0 0.60751 -15 30.0 71.0438 0.97876 1.99126 25.785 45.1238)
            #f(28.62 22.3088 35.5725 11.9475 6.27751 35.9438 55.5525 2.09251 37.0575 100.879 86.94 5.83876 25.7175 -1.75499 37.4625 7.45876 19.7775 101.621 85.995)
            #f(28.9575 22.95 36.2475 12.2513 27.3375 34.6275 55.215 2.43001 36.72 100.879 86.94 6.17626 34.1888 -3.71249 37.7663 7.79626 19.4738 101.621 85.995)
            #f(28.9575 22.95 36.2475 12.2513 27.3375 34.6275 55.215 2.43001 0.0 100.879 86.94 6.17626 34.1888 -3.71249 37.7663 7.79626 0.0 101.621 85.995)
            #f(28.9575 22.95 36.2475 12.2513 27.3375 34.6275 55.215 2.43001 0.0 60.0 86.94 6.17626 34.1888 -3.71249 37.7663 7.79626 0.0 60.0 85.995)
            #f(28.9575 22.95 36.2475 12.2513 27.3375 34.6275 55.215 2.43001 0.0 30.0 86.94 6.17626 34.1888 -3.71249 37.7663 7.79626 0.0 30.0 85.995)
            #f(20.2163 29.0588 36.2475 13.23 11.5425 73.6425 138.004 2.09251 28.755 7.83001 20.0 1.24876 10.125 100.474 76.8825 1.62001 9.24751 25.1438 20.0)))

(defun walk
  (step)
  (let (angle-list)
    (dotimes (i step)
      (setq angle-list (append angle-list walk-angle)))
    (send *ri* :angle-vector-sequence angle-list (make-list (length angle-list) :initial-element 600))
    (send *ri* :wait-interpolation)
    ))

(setq index-joints (list "INDEX0" "INDEX1" "INDEX2" "INDEX3"))
(setq middle-joints (list "MIDDLE0" "MIDDLE1" "MIDDLE2" "MIDDLE3"))
(setq ring-joints (list "RING0" "RING1" "RING2" "RING3"))
(setq little-joints (list "LITTLE0" "LITTLE1" "LITTLE2" "LITTLE3"))
(setq thumb-joints (list "THUMB0" "THUMB1" "THUMB2"))
(defun servo-off (name)
  (send *ri* :servo-off :names (flatten name)))

;; 垂直に立つ姿勢
;; #f(90.9225 -60.885 39.15 27.945 34.2225 -18.2587 -60.4125 10.125 -16.6387 -39.3525 -47.3175 6.17626 1.72126 -40.1962 -47.5875 -0.26999 17.2463 4.25251 -49.0725)

(setq walk-angle
      (list
;; #f(93.2175 23.2538 39.825 33.8175 15.8288 56.4638 -90.7875 16.2 -9.95624 65.3063 -91.125 -3.91499 -6.74999 54.5738 -88.9987 -21.8362 -12.5887 65.2725 -46.71)
;; 指を上げる
#f(102.33 28.08 40.77 32.8388 13.5 56.4638 -89.505 17.1788 -10.2937 23.49 -50.5912 -6.17624 -16.8412 58.2863 92.745 -14.6475 -5.46749 20.25 -48.06)
;; 指を曲げる
#f(102.026 27.7763 40.77 28.9575 -6.37874 58.1175 55.4513 16.2 -6.68249 23.49 -49.6125 -10.6987 -20.7562 53.9663 66.0825 -14.0062 -4.11749 20.25 -47.0475)
;; 指接地
#f(103.005 9.14626 6.04126 38.0363 -9.61874 83.8688 84.0375 13.9725 -13.2975 9.11251 -6.47999 -11.34 -17.5162 95.2088 93.3188 -13.6687 7.02001 -8.87624 5.80501)

#f(100.373 20.385 39.825 19.2713 -9.61874 78.2663 93.4538 7.22251 -19.6087 0.81001 56.9025 -4.89374 -23.6925 82.6875 95.2763 -14.6475 -21.3975 39.1838 12.2513)
;; 指を上げる
#f(101.689 16.5375 40.4663 28.6538 0.13501 27.0 100.946 4.01626 -8.30249 12.96 84.2738 -7.45874 -26.9662 42.525 99.7988 -19.8787 -9.51749 57.1388 12.5888)
;; 指を曲げる
#f(101.351 16.8413 40.77 28.9575 -8.30249 22.68 -10.5637 5.94001 -14.9512 67.9388 95.2425 -6.47999 -23.6925 25.8188 -12.3862 -18.5625 -18.6975 76.3088 58.6575)
;; 指接地
#f(102.026 11.07 -1.72124 28.6538 20.7563 12.42 -18.09 6.27751 -5.02874 99.225 75.9713 -9.38249 -8.70749 10.6988 -13.3312 -27.3712 -7.15499 97.065 60.9188)

#f(103.646 20.0475 27.135 27.3375 8.91001 27.9788 1.48501 8.50501 -18.9675 74.5538 86.94 -8.43749 -24.6712 40.9725 -2.36249 -28.35 -24.435 67.5338 71.6175)
#f(104.963 23.5913 29.7338 28.3163 8.57251 27.675 1.14751 7.56001 -20.2837 54.4388 95.9175 -7.45874 -25.0087 39.7575 -2.69999 -27.7087 -24.0975 39.1838 71.6175)
))

;; 薬指と小指で歩く（水平）
(setq cup-angle
      (list
#f(6.95251 68.1413 27.7763 4.05001 71.415 84.8475 74.925 56.2613 32.7375 60.3788 101.891 -45.5287 -3.50999 5.73751 -25.6162 -54.4725 -23.76 16.6725 -21.9712)
#f(8.91001 68.1413 27.135 4.05001 70.1325 93.7575 74.925 55.9575 30.7463 59.7038 101.588 -48.1275 -17.82 43.1325 60.885 -49.5787 -23.4225 34.6275 73.9125)
))

;; バランスを修正
(setq pointing-angle
      (list
#f(100.069 1.78876 -71.8875 47.7225 47.1488 32.2988 -79.11 6.91876 36.72 26.9325 -74.2162 -24.57 7.25626 55.215 -42.39 -49.5787 10.8338 55.1813 -54.5062)
#f(134.325 22.6125 44.3475 27.0338 19.0013 14.0738 5.70376 6.27751 12.1838 24.9413 56.2275 -23.2875 19.5413 47.4863 -42.7275 -43.065 53.6288 -0.26999 -54.1687)
#f(100.71 62.4038 53.7638 22.5113 20.2838 -1.75499 11.88 5.29876 25.4475 40.365 101.891 -25.8525 10.8 78.435 63.4838 -48.6 27.135 70.7738 77.1863)
#f(92.88 89.3025 64.8338 16.3688 -11.9137 -9.01124 8.64001 9.48376 38.7113 94.2975 62.4038 -23.2875 37.7325 83.3625 71.5838 -51.5362 44.3813 80.8313 73.2713)
))

(setq cup-angle
      (list
#f(16.335 86.4338 36.2475 52.5825 19.6425 99.36 72.9675 9.78751 6.88501 82.2488 47.1488 -4.89374 -4.79249 88.29 30.5438 -17.9212 -16.3012 96.12 27.1013)
;; raise up middle, ring
#f(17.6513 86.4338 37.2263 52.5825 16.74 99.0225 74.6213 10.7663 -14.9512 81.27 48.1275 -5.19749 -24.03 85.0163 31.185 -16.605 -17.9887 94.8038 27.7425)
;; move forwaed
#f(16.9763 86.4338 36.8888 52.5825 15.4238 99.36 73.9463 9.48376 4.92751 54.81 25.6838 -4.55624 4.32001 43.7738 31.185 -15.2887 -15.2887 93.5213 27.405)
;; ground
#f(16.9763 86.4338 36.5513 52.245 7.99876 99.6975 75.2625 8.20126 20.8238 64.6313 -46.3387 -5.83874 21.8363 49.6463 -39.15 -14.31 -19.035 91.8675 26.4263)
;; little
#f(16.9763 86.0963 36.8888 52.5825 8.30251 100.001 75.5663 8.50501 19.4738 64.6313 -46.98 -5.53499 21.8363 48.3975 -40.1287 -10.0575 -23.085 74.3513 31.9275)
#f(16.335 86.0963 36.8888 52.5825 8.64001 100.001 75.9038 8.20126 19.4738 64.6313 -46.3387 -3.91499 21.195 48.3975 -41.4112 -12.015 9.58501 25.1438 29.3288)
#f(16.0313 86.0963 36.2475 52.5825 8.64001 100.339 75.9038 8.20126 19.4738 63.99 -47.3175 -4.89374 20.8575 49.005 -42.0862 -17.2462 25.2113 29.0588 -30.105)
;; bending
#f(15.6938 85.455 35.91 51.9413 8.30251 98.3813 80.7975 9.78751 13.8713 94.635 -72.5962 -7.12124 3.34126 82.0463 -44.01 -18.9 2.66626 72.7313 -41.9512)
#f(15.0525 85.455 35.5725 52.5825 8.30251 98.0438 81.4388 10.7663 -4.35374 84.51 15.93 -7.12124 -10.0237 82.3838 9.65251 -19.5412 -10.5637 73.71 12.8925)
))


;; 掌をつけて歩く
(setq test-angle
      (list
#f(21.8363 32.9063 44.3475 -11.34 70.4363 101.993 57.0713 -11.1712 106.448 84.51 32.8388 -12.6225 96.1538 91.26 37.0575 -14.31 62.8763 101.959 62.8425)
;; little, middleを前に出す
;; 指先を丸める 3:90->1:60/30
#f(21.5325 32.5688 44.3475 -10.3275 69.795 101.993 57.0713 -10.53 106.144 84.2063 90.0 -12.6225 95.5125 91.26 37.0575 -14.31 62.5725 101.621 90)
#f(21.5325 32.5688 44.3475 -10.3275 69.795 101.993 57.0713 -10.53 60.0 84.2063 90.0 -12.6225 95.5125 91.26 37.0575 -14.31 30 101.621 90)
#f(22.1738 31.9275 44.3475 -10.3275 68.5125 101.993 57.4088 -10.1925 47.9588 48.2288 98.5838 -14.2425 95.8163 99.495 34.7625 -12.3525 25.8525 59.0963 90.2138)
#f(23.7938 31.9275 43.7063 -11.6437 68.175 101.993 56.7675 -7.59374 72.3263 -0.60749 -39.7912 -11.0025 95.8163 99.495 33.48 -9.07874 53.9325 0.03376 -17.9212)

#f(23.7938 31.6238 43.7063 -11.6437 67.8713 101.993 90.0 -7.93124 72.3263 -0.26999 -39.4875 -11.6437 95.5125 99.7988 90.0 -9.07874 54.5738 0.03376 -17.55)
#f(23.7938 31.6238 43.7063 -11.6437 30.0 101.993 90.0 -7.93124 72.3263 -0.26999 -39.4875 -11.6437 40.0 99.7988 90.0 -9.07874 54.5738 0.03376 -17.55)
#f(19.2375 31.9275 43.3688 -0.10124 -5.16374 87.48 72.9675 -8.26874 54.6075 -1.58624 -41.1075 -9.07874 5.94001 73.17 80.6625 -8.77499 44.9888 -1.58624 -19.9462)
#f(17.955 32.9063 43.7063 1.14751 37.4288 5.80501 -17.7525 -8.26874 50.2875 -1.24874 -40.4662 -6.81749 36.1125 15.6263 -30.78 -8.77499 42.12 -0.60749 -22.9837)

#f(16.9763 32.9063 43.065 0.50626 34.5263 2.16001 59.0288 -1.41749 35.7075 -0.94499 59.805 -4.89374 36.45 -0.10124 60.2438 -3.54374 34.7963 -1.58624 58.0163)
#f(16.9763 32.9063 42.7275 2.43001 -3.54374 83.5313 62.6063 -6.61499 10.8675 77.355 83.295 -5.83874 -2.83499 89.9438 61.5263 -3.54374 -5.46749 78.2325 59.94)
))

;; 鉛筆を持つ
;; 通常
#f(89.3025 71.9888 41.7488 50.625 62.37 101.318 -20.385 17.1788 86.4338 96.93 42.93 17.0775 86.2988 97.1663 99.1575 10.3613 65.4413 95.7825 101.014)
;; 右に動かす
#f(93.8588 78.7388 -31.8937 25.4138 69.1538 79.92 -28.5525 25.8188 108.101 33.8175 28.2825 12.1163 102.094 65.2725 65.1375 10.6988 81.6413 101.284 89.5725)

#f(83.7338 62.4038 -4.92749 39.3188 72.0563 73.98 -35.4037 18.4613 102.87 43.9763 41.6138 12.7913 108.979 65.61 65.745 10.6988 88.6275 101.284 90.8888)
#f(95.175 48.6 42.0863 31.5563 72.36 95.4113 -39.96 14.2763 106.448 65.3063 37.0575 13.095 108.338 64.935 65.745 11.0363 87.0413 101.284 91.1925)


#f(97.1325 59.5013 0.50626 32.1975 99.36 22.0388 13.5 16.8413 108.776 49.2075 0.03376 12.1163 98.145 92.2388 56.6325 11.6775 76.8825 99.6638 78.8063)
#f(104.625 78.0975 0.16876 16.6725 72.36 60.4463 43.74 9.78751 92.0363 98.2125 -2.22749 14.445 89.91 92.2388 56.3288 10.6988 69.5925 91.8675 78.4688)

#f(94.1963 57.2738 -24.5362 15.6938 101.993 10.7663 12.2175 3.71251 110.396 19.3725 19.2038 5.16376 87.9188 93.8925 57.3075 0.97876 81.3038 100.643 79.1438)
#f(104.625 75.5325 -35.4375 44.1788 72.6975 75.6338 6.34501 13.3313 91.6988 101.183 46.5075 13.095 103.073 84.6788 59.5688 11.0363 79.7175 96.4238 78.8063)
